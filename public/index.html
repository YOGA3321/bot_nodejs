<!DOCTYPE html>
<html>
<head>
    <title>Dashboard Bot Real-Time</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1e1e1e; color: #d4d4d4; margin: 0; padding: 20px; }
        .container { display: flex; gap: 20px; }
        .main-panel { flex-grow: 1; }
        .side-panel { width: 350px; flex-shrink: 0; }
        .box { background: #2a2a2a; border: 1px solid #444; border-radius: 8px; padding: 15px; margin-bottom: 20px; }
        h1, h2, h3 { color: #5d9cec; border-bottom: 1px solid #444; padding-bottom: 10px; margin-top: 0; }
        .log-container { height: 500px; overflow-y: auto; background: #111; color: #a5c9a5; padding: 10px; font-family: 'Consolas', 'Menlo', monospace; font-size: 14px; white-space: pre-wrap; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 8px; text-align: left; border-bottom: 1px solid #444; }
        .status-open { color: #f9a825; }
        .status-filled { color: #7cb342; }
        .balance-item { display: flex; justify-content: space-between; font-size: 1.2em; margin-bottom: 10px; }
    </style>
</head>
<body>
    <h1>ðŸ“Š Dashboard Bot Real-Time</h1>
    <div class="container">
        <div class="main-panel">
            <div class="box">
                <h2>Log Aktivitas</h2>
                <div class="log-container" id="logBox"></div>
            </div>
        </div>
        <div class="side-panel">
            <div class="box">
                <h3>Harga Saat Ini</h3>
                <div id="priceDisplay" style="font-size: 2em; color: white; text-align: center;">-</div>
            </div>
            <div class="box">
                <h3>Saldo</h3>
                <div id="balances">
                    <div class="balance-item"><span>ETH:</span> <span id="ethBalance">-</span></div>
                    <div class="balance-item"><span>USDT:</span> <span id="usdtBalance">-</span></div>
                </div>
            </div>
            <div class="box">
                <h3>Status Grid</h3>
                <table id="gridTable">
                    <thead><tr><th>Tipe</th><th>Harga</th><th>Status</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

        const logBox = document.getElementById('logBox');
        const priceDisplay = document.getElementById('priceDisplay');
        const gridTableBody = document.querySelector('#gridTable tbody');
        const ethBalanceSpan = document.getElementById('ethBalance');
        const usdtBalanceSpan = document.getElementById('usdtBalance');

        // Listener untuk log baru
        socket.on('new_log', (message) => {
            logBox.innerHTML += `<div>${message}</div>`;
            logBox.scrollTop = logBox.scrollHeight;
        });

        // Listener untuk harga baru
        socket.on('price_update', (price) => {
            priceDisplay.innerText = parseFloat(price).toFixed(2);
        });

        // Listener untuk update data grid
        socket.on('grid_update', (grids) => {
            gridTableBody.innerHTML = ''; // Kosongkan tabel
            grids.forEach(grid => {
                const row = `<tr>
                               <td>${grid.type}</td>
                               <td>${grid.price}</td>
                               <td class="status-${grid.status.toLowerCase()}">${grid.status}</td>
                             </tr>`;
                gridTableBody.innerHTML += row;
            });
        });
        
        // Listener untuk update saldo
        socket.on('balance_update', (balances) => {
            ethBalanceSpan.innerText = parseFloat(balances.eth).toFixed(6);
            usdtBalanceSpan.innerText = parseFloat(balances.usdt).toFixed(2);
        });
    </script>
</body>
</html>
